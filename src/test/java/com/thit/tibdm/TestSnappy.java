package com.thit.tibdm;

import com.google.common.base.Charsets;
import org.junit.Test;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.xerial.snappy.Snappy;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.nio.ByteBuffer;
import java.nio.channels.FileChannel;

/**
 * @author wanghaoqiang
 * @date 2018/7/3
 * @time 13:56
 */
public class TestSnappy {

    private static final Logger LOGGER = LoggerFactory.getLogger(TestSnappy.class);

    @Test
    public void testSnappy() throws IOException {
        String str = "000107d008020006160808014b006e033f0343002c00170020005a90fc00250187002e01870031018700260187002d002701000000000005085c07a808b608e808e808de08de08a2088e08b6082a0776000000d07e074f1b30748718051040d001ddc70074050a0000000000000000001b1a1b441ac61a8500000000000000000f0002cd02d102c902c305fe061105f9060d55004d00a7004d004d00add07e0a4f1b30748700011000d001cec70074050a00001d00a8004d001d00ad1c2a19281860195a19281932193217f2182e18421bc6181a00000000000000000000000000000000000000000000000000000000000000000000000000230023002300230023002341780000413c000041b44178002000ee7f2802001000ee432e02051000ee432e02052000ee7f280200000020100804028140201008040281402010080402814020100804028140201008040281402010080402814020100804028140201008040000fb012100f500100000fb012800f5000000f9012a00f5000000f6012000f5000000f7012300f5000000f9011f00f500201b1a1b441ac61a85060e061f061c060402000207020802010000000000004844240614061606160616ff0025002e00310026018701870187018700740073000300020001000000200020ff005502cd02d102c902c30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000985612800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000575658595859595b535a5b5b5c5a5b5c5d5a5c5b5c5c5c5b5d5e5b5d5d5c5b5b5c5c5c5c5b5b5a5b5c5c5b5d5a585858585859595b540000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000458b00004e510000ba21000c71d000042a11000265210000f4d80001000000000000000000000000000000000000000000000000000000120703100e210075007800790078008300800083008500800079007e0082008100800081007d055d055c055b055c055b055d055c055b055d055b055c055a055f055d055d055c21840000000000000000003d130011000f000f00113d13050005110102010000010000060001020300030003000300030003000500051101020100000100000600010203000300030003000300030040c340c340c340c301000100000500050300030003000300030003000300030001020102010201020102010201020102020002000200020003090309030903090101025001010250010102500101025001800180018001800180018002050205020502050205020502050205020502050205020500010001000000000000000000000000000100010200030100000100000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000201850000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
        byte[] beforeBytes = str.getBytes();
        long start = System.currentTimeMillis();
        LOGGER.info("压缩前大小：{}b", beforeBytes.length);
        byte[] compress = Snappy.compress(beforeBytes);
        LOGGER.info("压缩后大小：{}b", compress.length);
        long end = System.currentTimeMillis();
        LOGGER.info("压缩消耗时间为：{}", end - start);
    }
}
